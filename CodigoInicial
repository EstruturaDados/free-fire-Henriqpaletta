#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <stdbool.h> 

// --- DEFINI√á√ÉO DA ESTRUTURA (STRUCT) ---

// Struct Item: armazena as informa√ß√µes de um recurso coletado.
struct Item {
    char nome[30];
    char tipo[20]; // Ex: arma, municao, cura
    int quantidade;
};

// --- VARI√ÅVEIS DO INVENT√ÅRIO (LISTA SEQUENCIAL) ---

#define MAX_ITENS 10 
// Vetor de structs que representa a mochila
struct Item inventario[MAX_ITENS]; 
// Contador que rastreia o n√∫mero atual de itens
int contadorItens = 0; 

// --- PROT√ìTIPOS DE FUN√á√ïES ---
void inserirItem();
void listarItens();
void buscarItem();
void removerItem();
void exibirMenu();


// --- IMPLEMENTA√á√ÉO DAS FUN√á√ïES ---

/**
 * Adiciona um novo item na primeira posi√ß√£o vazia do vetor.
 */
void inserirItem() {
    if (contadorItens >= MAX_ITENS) {
        printf("\nInvent√°rio cheio! Maximo de %d itens.\n", MAX_ITENS);
        return;
    }

    printf("\n--- CADASTRAR ITEM ---\n");
    
    // Leitura dos dados
    printf("Nome: ");
    scanf("%29s", inventario[contadorItens].nome); 

    printf("Tipo (ex: arma, cura, municao): ");
    scanf("%19s", inventario[contadorItens].tipo);

    printf("Quantidade: ");
    scanf("%d", &inventario[contadorItens].quantidade);

    // Incrementa o contador
    contadorItens++;
    printf("\nItem adicionado. Espacos livres: %d.\n", MAX_ITENS - contadorItens);
}

/**
 * Lista todos os itens e suas propriedades.
 */
void listarItens() {
    if (contadorItens == 0) {
        printf("\nInvent√°rio vazio.\n");
        return;
    }

    printf("\n--- ITENS NA MOCHILA (Total: %d) ---\n", contadorItens);
    int i;
    for (i = 0; i < contadorItens; i++) {
        // Exibe as propriedades do struct
        printf("[%d] %s (Tipo: %s, Qtd: %d)\n", 
               i, inventario[i].nome, inventario[i].tipo, inventario[i].quantidade);
    }
    printf("-----------------------------------\n");
}

/**
 * Busca sequencial por nome do item.
 */
void buscarItem() {
    if (contadorItens == 0) {
        printf("\nInvent√°rio vazio.\n");
        return;
    }

    char nomeBusca[30];
    printf("\n--- BUSCAR ITEM ---\n");
    printf("Digite o nome do item: ");
    scanf("%29s", nomeBusca);

    int i;
    // Percorre o vetor usando busca sequencial
    for (i = 0; i < contadorItens; i++) {
        if (strcmp(inventario[i].nome, nomeBusca) == 0) {
            printf("\nItem encontrado:\n");
            printf("Nome: %s | Tipo: %s | Qtd: %d\n", 
                   inventario[i].nome, inventario[i].tipo, inventario[i].quantidade);
            return; 
        }
    }

    printf("\nItem '%s' nao encontrado.\n", nomeBusca);
}

/**
 * Remove um item por nome e reorganiza o vetor por deslocamento (shifting).
 */
void removerItem() {
    if (contadorItens == 0) {
        printf("\nInvent√°rio vazio.\n");
        return;
    }

    char nomeRemover[30];
    printf("\n--- REMOVER ITEM ---\n");
    printf("Digite o nome do item a ser removido: ");
    scanf("%29s", nomeRemover);

    int i, indiceEncontrado = -1;

    // 1. Busca Sequencial
    for (i = 0; i < contadorItens; i++) {
        if (strcmp(inventario[i].nome, nomeRemover) == 0) {
            indiceEncontrado = i;
            break;
        }
    }

    if (indiceEncontrado == -1) {
        printf("\nItem '%s' nao encontrado para remocao.\n", nomeRemover);
        return;
    }

    // 2. Deslocamento: Move os itens para preencher o espaco vazio
    for (i = indiceEncontrado; i < contadorItens - 1; i++) {
        inventario[i] = inventario[i+1]; 
    }

    // 3. Atualiza o contador
    contadorItens--;
    printf("\nItem '%s' removido. Espacos livres: %d.\n", nomeRemover, MAX_ITENS - contadorItens);
}

/**
 * Exibe o menu principal de op√ß√µes.
 */
void exibirMenu() {
    printf("\n=========================\n");
    printf(" INVENTARIO SIMPLES\n");
    printf("=========================\n");
    printf("1. Cadastrar Item\n");
    printf("2. Buscar Item\n");
    printf("3. Remover Item\n");
    printf("0. Sair\n");
    printf("-------------------------\n");
    printf("Opcao: ");
}


// --- FUN√á√ÉO PRINCIPAL (MAIN) ---

int main() {
    int opcao;

    do {
        // Requisito: Listar itens ap√≥s cada opera√ß√£o.
        listarItens(); 

        exibirMenu();
        if (scanf("%d", &opcao) != 1) {
            // Tratamento basico de buffer
            printf("\nOpcao invalida. Digite um numero.\n");
            while (getchar() != '\n'); 
            continue;
        }

        switch (opcao) {
            case 1:
                inserirItem();
                break;
            case 2:
                buscarItem();
                break;
            case 3:
                removerItem();
                break;
            case 0:
                printf("\nPrograma encerrado. Bom jogo! üëã\n");
                break;
            default:
                printf("\nOpcao invalida.\n");
        }

    } while (opcao != 0);

    return 0;
}
